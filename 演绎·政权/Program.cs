using System;
using System.Text;

namespace 演绎_政权 {
    class Program {
        static void Main(string[] args) {
            Console.OutputEncoding = Encoding.UTF8;
            Console.SetWindowSize(144, 50);
            Console.BackgroundColor = ConsoleColor.White;
            Console.ForegroundColor = ConsoleColor.DarkBlue;
            Console.Title = "演绎·政权 by Pix-00";
            Banner();
            GV.rng = new Random();
            GV.screen = new Output.Screen();
            GV.timeLine = new Event.TimeLine();
            var action = new Event.Action(new Profile.Loader(GV.screen.Ask("请提供参数文件: ")));
            var map = new World.Map(new Profile.Loader(GV.screen.Ask("请提供地图文件: ")));

            while (true) {
                var c = map.Next();
                GV.screen.Flush();

                var s_ = GV.screen.Ask($"[{c.name},{c.m}]: ").Trim().Split(' ');
                var cat = 0u;
                string[] cmd;
                if (s_.Length < 2) {
                    s_ = new string[] { s_[0], "0" };
                }
                if (s_[0].Contains('#')) {
                    cat = 1u;
                    cmd = s_[0].Split('#');
                } else if (s_[0].Contains('%')) {
                    cat = 2u;
                    cmd = s_[0].Split('%');
                } else {
                    cmd = new string[] { s_[0], "" };
                }
                if (cmd[1].Length > 0) {
                    c = map.Select(Convert.ToInt32(cmd[1]));
                }
                try {
                    action.Parse(c, cat, cmd[0], s_[1]);
                } catch {

                }
            }
        }

        static void Banner() {
            Console.Clear();
            Console.WriteLine("\n");
            Console.WriteLine(
                "      ╔══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗\n" +
                "      ║                                                                                                                                  ║\n" +
                "      ║                                                                                                                                  ║\n" +
                "      ║     ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░     ║\n" +
                "      ║     ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░     ║\n" +
                "      ║     ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░     ║\n" +
                "      ║     ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░     ║\n" +
                "      ║     ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░     ║\n" +
                "      ║     ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░     ║\n" +
                "      ║     ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░     ║\n" +
                "      ║     ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░     ║\n" +
                "      ║     ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░     ║\n" +
                "      ║     ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░     ║\n" +
                "      ║     ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░     ║\n" +
                "      ║     ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░     ║\n" +
                "      ║     ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░     ║\n" +
                "      ║     ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░     ║\n" +
                "      ║                                                                                                                                  ║\n" +
                "      ║                                                                                                                                  ║\n" +
                "      ╟────────────────────────────────┬──────────────────────┬───────────────────────┬─────────────────────────────┬────────────────────╢\n" +
                "      ║                                                                                                                                  ║\n" +
                "      ║  ░░░░░░░░░░░░░░░░░░░░░░░░░░░░  │  ░░░░░░░░░░░░░░░░░░  │  ░░░░░░░░░░░░░░░░░░░  │  ░░░░░░░░░░░░░░░░░░░░░░░░░  │  ░░░░░░░░░░░░░░░░  ║\n" +
                "      ║                                                                                                                                  ║\n" +
                "      ╚════════════════════════════════╧══════════════════════╧═══════════════════════╧═════════════════════════════╧════════════════════╝\n"
            );

            string[] buffer1 = {
                "  $          $$                  $$.                                             $                 $$                   ",
                "  $$$         $$$               $$v    $$$$$$$$$$$$$$             $$$$$$$$$$$$  $$                 $$   $$$$$$$$$$$$$$$ ",
                "   '$$ $$$$$$$$$$$$$$$$$       }$$       $$       $$                    $$     $$                  $$     $$        $$$ ",
                "       $$             $$      a$$  .$     $$    $$Y                     $$    $$$$$$$$$$$$$    $$$$$$$$$} $$        $$  ",
                "$$       $$$$$$$$$$$$$       $$$   $$       $$$$h                       $$   $$$      $$          $$$     $$        $$  ",
                " $$$          p$             $$$$$$$     $$$$$$$$$$1               $$   $$   $ $@     $$          $$$     |$\\      $$   ",
                "   $$   $$$$$$$$$$$$$$$         i$$   $$$$   $$   %$$$             $$   $$$$$$ $$     $$         $$$$$$$   $$      $$   ",
                "        $$    p$     $$        $$n           $$           {$$}     $$   $$     j$$   $$         a$ $$ u$$  .$$    $$    ",
                "   $    $$$$$$$$$$$$$$$       $$   _$  $$$$$$$$$$$$$$     {$$}     $$   $$      $$~ $$$        $$/ $$  \\$   $$$  $$     ",
                "   $$   $$    p$     $$      $$$$$$$%        $$                    $$   $$       $$&$$         $$  $$        $$$$$      ",
                "   $$   $$$$$$$$$$$$$$$                      $$                    $$   $$        $$$          ?   $$         $$$       ",
                "  $$    ''  ++   ++  ''            /$ $$$$$$$$$$$$$$$$             $$m$$$$$$$$  $$$n$$$            $$       $$$ $$$$    ",
                " $$       $$$     $$$        $$$$$$$?        $$                  $$$$$        $$$J   $$$$          $$    $$$$     $$$$$ ",
                "@$$    $$$k         t$$$                     $$                            <$$$`       I$$$        $$ $$$$$          $$$"
            };
            Console.ForegroundColor = ConsoleColor.DarkCyan;
            Console.CursorTop = 5;
            foreach (var l in buffer1) {
                Console.CursorLeft = 12;
                Console.Write(l);
                Console.CursorTop += 1;
            }

            string[] buffer2 = {
                "Author: Pix-00 -> GitHub.com",
                "QQ: K3 (291232454)",
                "License: Apache 2.0",
                "Init Release: 15-Jan-2020",
                "Nonce: 759934019"
            };
            Console.ForegroundColor = ConsoleColor.Magenta;
            Console.CursorTop += 4;
            Console.CursorLeft = 9;
            foreach (var l in buffer2) {
                Console.Write(l);
                Console.CursorLeft += 5;
            }

            Console.ForegroundColor = ConsoleColor.DarkBlue;
            Console.CursorTop = 26;
            Console.WriteLine();
        }
    }
}

